(function(){define("libra/templates/global-map",["libra/vendor/handlebars"],function(Handlebars){this["Templates"]=this["Templates"]||{};this["Templates"]["map-areas"]=Handlebars.template({1:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,alias1=container.lambda,alias2=container.escapeExpression,alias3=depth0!=null?depth0:container.nullContext||{},alias4=container.hooks.helperMissing,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return'    <div \n      class="m-gi-area-detail-box lb-border-p lb-box lb-box-pw" \n      data-id="'+alias2(alias1((stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"areaId"):stack1,depth0))+'" \n      tabindex="0"\n      aria-label="'+alias2((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||alias4).call(alias3,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"areaName"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:7,column:18},end:{line:7,column:68}}}))+'"\n      >\n      <div class="lb-modal-close-container">\n        <a class="lb-modal-close" role="button" tabindex="0" aria-label="'+alias2(alias1(depths[1]!=null?lookupProperty(depths[1],"closeText"):depths[1],depth0))+'">\n          <span class="lb-sr-only">'+alias2(alias1(depths[1]!=null?lookupProperty(depths[1],"closeText"):depths[1],depth0))+"</span>\n        </a>\n      </div>\n      <h2>"+alias2((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||alias4).call(alias3,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"areaName"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:14,column:10},end:{line:14,column:60}}}))+"</h2>\n      "+((stack1=(lookupProperty(helpers,"cleanText")||depth0&&lookupProperty(depth0,"cleanText")||alias4).call(alias3,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"areaDescription"):stack1,{name:"cleanText",hash:{},data:data,loc:{start:{line:15,column:6},end:{line:15,column:59}}}))!=null?stack1:"")+"\n"+((stack1=lookupProperty(helpers,"if").call(alias3,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"edgeLocations"):stack1,{name:"if",hash:{},fn:container.program(2,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:16,column:6},end:{line:19,column:13}}}))!=null?stack1:"")+((stack1=lookupProperty(helpers,"if").call(alias3,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"regionalEdgeCaches"):stack1,{name:"if",hash:{},fn:container.program(4,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:20,column:6},end:{line:23,column:13}}}))!=null?stack1:"")+((stack1=lookupProperty(helpers,"if").call(alias3,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"localRegions"):stack1,{name:"if",hash:{},fn:container.program(6,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:24,column:6},end:{line:27,column:13}}}))!=null?stack1:"")+((stack1=lookupProperty(helpers,"if").call(alias3,depths[1]!=null?lookupProperty(depths[1],"isCtaNotBlank"):depths[1],{name:"if",hash:{},fn:container.program(8,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:28,column:6},end:{line:30,column:13}}}))!=null?stack1:"")+"    </div>\n"},2:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,alias1=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"        <h4>"+alias1(container.lambda(depths[1]!=null?lookupProperty(depths[1],"edgeLocationText"):depths[1],depth0))+":</h4>\n        <p>"+alias1((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||container.hooks.helperMissing).call(depth0!=null?depth0:container.nullContext||{},(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"edgeLocations"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:18,column:11},end:{line:18,column:66}}}))+"</p>\n"},4:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,alias1=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"        <h4>"+alias1(container.lambda(depths[1]!=null?lookupProperty(depths[1],"regionalEdgeCachesText"):depths[1],depth0))+":</h4>\n        <p>"+alias1((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||container.hooks.helperMissing).call(depth0!=null?depth0:container.nullContext||{},(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"regionalEdgeCaches"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:22,column:11},end:{line:22,column:71}}}))+"</p>\n"},6:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,alias1=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"        <h4>"+alias1(container.lambda(depths[1]!=null?lookupProperty(depths[1],"localRegionsText"):depths[1],depth0))+":</h4>\n        <p>"+alias1((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||container.hooks.helperMissing).call(depth0!=null?depth0:container.nullContext||{},(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"localRegions"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:26,column:11},end:{line:26,column:65}}}))+"</p>\n"},8:function(container,depth0,helpers,partials,data,blockParams,depths){var alias1=container.lambda,alias2=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return'        <a href="'+alias2(alias1(depths[1]!=null?lookupProperty(depths[1],"areaModalCtaURL"):depths[1],depth0))+'">'+alias2(alias1(depths[1]!=null?lookupProperty(depths[1],"areaModalCtaText"):depths[1],depth0))+"</a>\n"},compiler:[8,">= 4.3.0"],main:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"<section>\n"+((stack1=lookupProperty(helpers,"each").call(depth0!=null?depth0:container.nullContext||{},depth0!=null?lookupProperty(depth0,"items"):depth0,{name:"each",hash:{},fn:container.program(1,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:2,column:2},end:{line:32,column:11}}}))!=null?stack1:"")+"</section>\n"},useData:true,useDepths:true});this["Templates"]["map-modal"]=Handlebars.template({1:function(container,depth0,helpers,partials,data){var helper,alias1=depth0!=null?depth0:container.nullContext||{},alias2=container.hooks.helperMissing,alias3="function",alias4=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return'    <a class="m-gi-map-modal-cta" href='+alias4((helper=(helper=lookupProperty(helpers,"ctaURL")||(depth0!=null?lookupProperty(depth0,"ctaURL"):depth0))!=null?helper:alias2,typeof helper===alias3?helper.call(alias1,{name:"ctaURL",hash:{},data:data,loc:{start:{line:4,column:39},end:{line:4,column:49}}}):helper))+">"+alias4((helper=(helper=lookupProperty(helpers,"ctaText")||(depth0!=null?lookupProperty(depth0,"ctaText"):depth0))!=null?helper:alias2,typeof helper===alias3?helper.call(alias1,{name:"ctaText",hash:{},data:data,loc:{start:{line:4,column:50},end:{line:4,column:61}}}):helper))+"</a>\n"},3:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,alias1=depth0!=null?depth0:container.nullContext||{},alias2=container.hooks.helperMissing,alias3=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"    <div \n"+((stack1=(lookupProperty(helpers,"ifEven")||depth0&&lookupProperty(depth0,"ifEven")||alias2).call(alias1,data&&lookupProperty(data,"index"),{name:"ifEven",hash:{},fn:container.program(4,data,0,blockParams,depths),inverse:container.program(6,data,0,blockParams,depths),data:data,loc:{start:{line:8,column:6},end:{line:12,column:17}}}))!=null?stack1:"")+'        data-id="'+alias3(container.lambda((stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"areaId"):stack1,depth0))+'"\n    >\n      <h3>'+alias3((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||alias2).call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"areaName"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:15,column:10},end:{line:15,column:60}}}))+"</h3>\n      "+((stack1=(lookupProperty(helpers,"cleanText")||depth0&&lookupProperty(depth0,"cleanText")||alias2).call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"areaDescription"):stack1,{name:"cleanText",hash:{},data:data,loc:{start:{line:16,column:6},end:{line:16,column:59}}}))!=null?stack1:"")+"\n"+((stack1=lookupProperty(helpers,"if").call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"edgeLocations"):stack1,{name:"if",hash:{},fn:container.program(8,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:17,column:6},end:{line:20,column:13}}}))!=null?stack1:"")+((stack1=lookupProperty(helpers,"if").call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"regionalEdgeCaches"):stack1,{name:"if",hash:{},fn:container.program(10,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:21,column:6},end:{line:24,column:13}}}))!=null?stack1:"")+((stack1=lookupProperty(helpers,"if").call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"localRegions"):stack1,{name:"if",hash:{},fn:container.program(12,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:25,column:6},end:{line:28,column:13}}}))!=null?stack1:"")+((stack1=lookupProperty(helpers,"if").call(alias1,(stack1=depths[1]!=null?lookupProperty(depths[1],"areasHbsContextJSON"):depths[1])!=null?lookupProperty(stack1,"isCtaNotBlank"):stack1,{name:"if",hash:{},fn:container.program(14,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:29,column:6},end:{line:31,column:13}}}))!=null?stack1:"")+"    </div>\n"},4:function(container,depth0,helpers,partials,data){return'        class="m-gi-area-detail-box lb-border-p lb-box lb-box-pw"\n'},6:function(container,depth0,helpers,partials,data){return'        class="m-gi-area-detail-box lb-box"\n'},8:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,alias1=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"        <h4>"+alias1(container.lambda((stack1=depths[1]!=null?lookupProperty(depths[1],"areasHbsContextJSON"):depths[1])!=null?lookupProperty(stack1,"edgeLocationText"):stack1,depth0))+":</h4>\n        <p>"+alias1((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||container.hooks.helperMissing).call(depth0!=null?depth0:container.nullContext||{},(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"edgeLocations"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:19,column:11},end:{line:19,column:66}}}))+"</p>\n"},10:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,alias1=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"        <h4>"+alias1(container.lambda((stack1=depths[1]!=null?lookupProperty(depths[1],"areasHbsContextJSON"):depths[1])!=null?lookupProperty(stack1,"regionalEdgeCachesText"):stack1,depth0))+":</h4>\n        <p>"+alias1((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||container.hooks.helperMissing).call(depth0!=null?depth0:container.nullContext||{},(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"regionalEdgeCaches"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:23,column:11},end:{line:23,column:71}}}))+"</p>\n"},12:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,alias1=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"        <h4>"+alias1(container.lambda((stack1=depths[1]!=null?lookupProperty(depths[1],"areasHbsContextJSON"):depths[1])!=null?lookupProperty(stack1,"localRegionsText"):stack1,depth0))+":</h4>\n        <p>"+alias1((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||container.hooks.helperMissing).call(depth0!=null?depth0:container.nullContext||{},(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"localRegions"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:27,column:11},end:{line:27,column:65}}}))+"</p>\n"},14:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,alias1=container.lambda,alias2=container.escapeExpression,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return'        <a href="'+alias2(alias1((stack1=depths[1]!=null?lookupProperty(depths[1],"areasHbsContextJSON"):depths[1])!=null?lookupProperty(stack1,"areaModalCtaURL"):stack1,depth0))+'">'+alias2(alias1(depths[1]!=null?lookupProperty(depths[1],"areaModalCtaText"):depths[1],depth0))+"</a>\n"},compiler:[8,">= 4.3.0"],main:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,helper,alias1=depth0!=null?depth0:container.nullContext||{},lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return'<section class="m-gi-map-area-details-container">\n  <h2>'+container.escapeExpression((helper=(helper=lookupProperty(helpers,"mapTitle")||(depth0!=null?lookupProperty(depth0,"mapTitle"):depth0))!=null?helper:container.hooks.helperMissing,typeof helper==="function"?helper.call(alias1,{name:"mapTitle",hash:{},data:data,loc:{start:{line:2,column:6},end:{line:2,column:18}}}):helper))+"</h2>\n"+((stack1=lookupProperty(helpers,"if").call(alias1,depth0!=null?lookupProperty(depth0,"ctaURL"):depth0,{name:"if",hash:{},fn:container.program(1,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:3,column:2},end:{line:5,column:9}}}))!=null?stack1:"")+((stack1=lookupProperty(helpers,"each").call(alias1,depth0!=null?lookupProperty(depth0,"items"):depth0,{name:"each",hash:{},fn:container.program(3,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:6,column:2},end:{line:33,column:11}}}))!=null?stack1:"")+"</section>\n"},useData:true,useDepths:true});this["Templates"]["map-pins"]=Handlebars.template({1:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,helper,alias1=depth0!=null?depth0:container.nullContext||{},alias2=container.hooks.helperMissing,alias3=container.lambda,alias4=container.escapeExpression,alias5="function",lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return'  <div \n    class="m-gi-pin-detail-box lb-popover lb-popover-aui lb-popover-mid-small '+((stack1=lookupProperty(helpers,"if").call(alias1,(lookupProperty(helpers,"strToBool")||depth0&&lookupProperty(depth0,"strToBool")||alias2).call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"isNew"):stack1,{name:"strToBool",hash:{},data:data,loc:{start:{line:4,column:84},end:{line:4,column:123}}}),{name:"if",hash:{},fn:container.program(2,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:4,column:78},end:{line:4,column:138}}}))!=null?stack1:"")+'" \n    data-id="m-gi-pin-popover-'+alias4(alias3(depths[1]!=null?lookupProperty(depths[1],"mapId"):depths[1],depth0))+"-"+alias4((helper=(helper=lookupProperty(helpers,"index")||data&&lookupProperty(data,"index"))!=null?helper:alias2,typeof helper===alias5?helper.call(alias1,{name:"index",hash:{},data:data,loc:{start:{line:5,column:45},end:{line:5,column:57}}}):helper))+'" \n    data-action="hover" \n    data-position="'+alias4((helper=(helper=lookupProperty(helpers,"directionLeft")||(depth0!=null?lookupProperty(depth0,"directionLeft"):depth0))!=null?helper:alias2,typeof helper===alias5?helper.call(alias1,{name:"directionLeft",hash:{},data:data,loc:{start:{line:7,column:19},end:{line:7,column:38}}}):helper))+'-top" \n    data-lb-comp="popover"\n    aria-label="'+alias4((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||alias2).call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"pinName"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:9,column:16},end:{line:9,column:65}}}))+'"\n    aria-labelledby="'+alias4(alias3(depths[1]!=null?lookupProperty(depths[1],"mapId"):depths[1],depth0))+"-pin-"+alias4((helper=(helper=lookupProperty(helpers,"index")||data&&lookupProperty(data,"index"))!=null?helper:alias2,typeof helper===alias5?helper.call(alias1,{name:"index",hash:{},data:data,loc:{start:{line:10,column:40},end:{line:10,column:52}}}):helper))+'-trigger" \n    >\n'+((stack1=lookupProperty(helpers,"if").call(alias1,(lookupProperty(helpers,"strToBool")||depth0&&lookupProperty(depth0,"strToBool")||alias2).call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"isNew"):stack1,{name:"strToBool",hash:{},data:data,loc:{start:{line:12,column:10},end:{line:12,column:49}}}),{name:"if",hash:{},fn:container.program(4,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:12,column:4},end:{line:14,column:11}}}))!=null?stack1:"")+"    <h2>"+alias4((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||alias2).call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"pinName"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:15,column:8},end:{line:15,column:57}}}))+"</h2>\n    <p>"+alias4((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||alias2).call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"pinDescription"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:16,column:7},end:{line:16,column:63}}}))+"</p>\n    <p>"+alias4((lookupProperty(helpers,"cleanHTMLEntity")||depth0&&lookupProperty(depth0,"cleanHTMLEntity")||alias2).call(alias1,(stack1=(stack1=depth0!=null?lookupProperty(depth0,"item"):depth0)!=null?lookupProperty(stack1,"additionalFields"):stack1)!=null?lookupProperty(stack1,"pinBodyText"):stack1,{name:"cleanHTMLEntity",hash:{},data:data,loc:{start:{line:17,column:7},end:{line:17,column:60}}}))+"</p>\n  </div>\n"},2:function(container,depth0,helpers,partials,data){return".m-new"},4:function(container,depth0,helpers,partials,data,blockParams,depths){var lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"      <span>"+container.escapeExpression(container.lambda(depths[1]!=null?lookupProperty(depths[1],"newPinText"):depths[1],depth0))+"</span>\n"},compiler:[8,">= 4.3.0"],main:function(container,depth0,helpers,partials,data,blockParams,depths){var stack1,lookupProperty=container.lookupProperty||function(parent,propertyName){if(Object.prototype.hasOwnProperty.call(parent,propertyName)){return parent[propertyName]}return undefined};return"<div>\n"+((stack1=lookupProperty(helpers,"each").call(depth0!=null?depth0:container.nullContext||{},depth0!=null?lookupProperty(depth0,"items"):depth0,{name:"each",hash:{},fn:container.program(1,data,0,blockParams,depths),inverse:container.noop,data:data,loc:{start:{line:2,column:2},end:{line:19,column:11}}}))!=null?stack1:"")+"</div>\n"},useData:true,useDepths:true});return Templates});define("librastandardlib/obj-utils/mixin",[],function(){"use strict";return function mixin(target,source){if(typeof target!=="object"||typeof source!=="object"){return target}Object.keys(source).forEach(function(key){if(!target.hasOwnProperty(key)){target[key]=source[key]}});return target}});define("libra/event-utils/event-keys",[],function(){return{ENTER:"Enter",ESC:"Esc",ESCAPE:"Escape",SPACE:" "}});define("libra/components/global-map-area",["directories/directories-bundle","libra/templates/global-map","librastandardlib/obj-utils/mixin","libra/event-utils/event-keys"],function(DirectoriesBundle,HandlebarsTemplates,mixin,eventKeys){var options={componentName:"GIMapArea",itemsConfig:{selector:".m-gi-map-area",containerClass:".m-gi-map-area-details-container"},templates:HandlebarsTemplates};var defaults={mapSelector:".m-gi-map",mapAssetContainerSelector:".m-gi-map-container",mapAreaSelector:".m-gi-map-area",mapSVGSelector:".m-gi-map-svg",mapBGSelector:"rect",activeClass:"m-active",areaDetailsBoxSelector:".m-gi-area-detail-box",areaDetailBoxCloseButtonSelector:".m-gi-area-detail-box .lb-modal-close",mapAssetPathAttrName:"asset-path"};function MapArea(elem){this.$elem=$(elem);this.$map=this.$elem.closest(defaults.mapSelector);this.mapElem=this.$map.get(0);this.mapAssetContainer=this.$map.find(defaults.mapAssetContainerSelector);this.mapAssetPath=this.$map.data(defaults.mapAssetPathAttrName);this.areasContext=this.$elem.data().hbsContext;this.loadMapAsset()}MapArea.prototype={processData:function(data,replaceContent){this.displayItems(data,replaceContent);this.attachClickEvents();this.attachAreaLabels()},attachClickEvents:function(){this.$areaDetailBoxes=this.$container.find(defaults.areaDetailsBoxSelector);var that=this;var areaDetailBoxIds=this.$elem.find(".m-gi-area-detail-box").map(function(idx,itm){return $(itm).data("id")}).get();var clickableMapAreas=this.$mapAreas.filter(function(idx,itm){return areaDetailBoxIds.indexOf($(itm).data("id"))>=0});clickableMapAreas.addClass("m-gi-map-click-area");clickableMapAreas.attr("tabindex","0");clickableMapAreas.click(function(_,callback){that.$selectedArea=$(this);that.$selectedAreaDetailBox=that.$container.find('[data-id="'+that.$selectedArea.data("id")+'"]');if(that.$areaDetailBoxes.hasClass(defaults.activeClass)){that.$areaDetailBoxes.removeClass(defaults.activeClass);clickableMapAreas.removeClass(defaults.activeClass)}else{var centerX=that.mapElem.offsetLeft+that.mapElem.offsetWidth/2;var centerY=that.mapElem.offsetTop+that.mapElem.offsetHeight/2;that.$selectedArea.addClass(defaults.activeClass);that.$selectedAreaDetailBox.css({left:centerX,top:centerY});that.$selectedAreaDetailBox.addClass(defaults.activeClass)}if(typeof callback==="function"){return callback()}});function closeDetailBox(){if(that.$selectedArea!==undefined){that.$selectedArea.removeClass(defaults.activeClass);that.$selectedAreaDetailBox.removeClass(defaults.activeClass)}}this.$mapBG.add(defaults.areaDetailBoxCloseButtonSelector).click(closeDetailBox);this.$map.find(defaults.areaDetailBoxCloseButtonSelector).on("keyup",function(event){if(event.key===eventKeys.ENTER||event.key===eventKeys.SPACE){closeDetailBox();that.$selectedArea.focus()}});clickableMapAreas.on("keyup",function(event){if(event.key===eventKeys.ENTER||event.key===eventKeys.SPACE){$(this).trigger("click",function(){that.$selectedAreaDetailBox.focus();that.$selectedArea.addClass(defaults.activeClass)})}}).focus(function(){$(this).addClass(defaults.activeClass)}).focusout(function(){$(this).removeClass(defaults.activeClass)});this.$map.on("keyup",function(event){if((event.key===eventKeys.ESCAPE||event.key===eventKeys.ESC)&&that.$selectedArea!==undefined){closeDetailBox();that.$selectedArea.focus()}})},attachAreaLabels:function(){this.$mapAreas.filter('[data-id="na"]').attr("aria-label",this.areasContext.naLabel);this.$mapAreas.filter('[data-id="sa"]').attr("aria-label",this.areasContext.saLabel);this.$mapAreas.filter('[data-id="emea"]').attr("aria-label",this.areasContext.emeaLabel);this.$mapAreas.filter('[data-id="apac"]').attr("aria-label",this.areasContext.apacLabel)},loadMapAsset:function(){var that=this;this.mapAssetContainer.load(this.mapAssetPath,function(response,status){if(status==="success"){that.$mapAreas=that.$map.find(defaults.mapAreaSelector);that.$mapBG=that.$map.find(defaults.mapBGSelector);that.$mapSVG=that.$map.find(defaults.mapSVGSelector);that.$map.css("visibility","visible");$(that.$mapSVG).append("<title>"+that.areasContext.svgTitle+"</title>").show();that.init(options);that.template=that.getTemplate();if(that.template){that.loadData({},true)}}})}};mixin(MapArea.prototype,DirectoriesBundle.DirectoriesMixin);return MapArea});define("librastandardlib/vendor/lodash-amd/modern/array/compact",[],function(){function compact(array){var index=-1,length=array?array.length:0,resIndex=-1,result=[];while(++index<length){var value=array[index];if(value){result[++resIndex]=value}}return result}return compact});define("directories/directories-utils/path-utils",["librastandardlib/vendor/lodash-amd/modern/array/compact"],function(_compact){var PathUtils={getRelativeItemId:function(directoryId,itemId){var relativeItemId=false;if(typeof directoryId!=="undefined"&&directoryId!==""&&typeof itemId!=="undefined"&&itemId!==""){var re=new RegExp("^"+directoryId+"#");relativeItemId=itemId.replace(re,"")}return relativeItemId},getItemIdFromPath:function(path){var parts=path.split(/\//);if(parts.length<=3){return false}return parts[parts.length-2]},cleanPath:function(path){return path.replace(/\/{2,}/,"/")},getLanguage:function(){if(typeof AWS==="object"&&AWS.PageSettings&&AWS.PageSettings.currentLanguage){return AWS.PageSettings.currentLanguage}return $("html").attr("lang")||"en-US"},getLocale:function(){var lang=this.getLanguage();if(lang){return lang.replace("-","_")}return"en_US"},getTagFromURL:function(fullPath,rootPath){if(rootPath===undefined){rootPath=""}var index=fullPath.indexOf(rootPath)+rootPath.length;var arrPath=_compact(fullPath.slice(index).split("/"));return arrPath.reduce(function(str,value,ind){if(ind>0){str=decodeURIComponent(str);if(ind===arrPath.length-1){str+="#"}else{str+="-"}}return str+decodeURIComponent(value)},"")}};return PathUtils});define("directories/configurations/default-config",["directories/directories-utils/path-utils"],function(PathUtils){return{templateConfig:{language:PathUtils.getLanguage()},itemsConfig:{selector:".aws-directories-items",endpoint:"/api/dirs/{{directoryId}}/items",eventDataLoad:"directory-cards-data-load",eventNamespace:"aws_directories_items",activeClass:"lb-active",containerClass:".aws-directories-container",loadTemplate:true,errorMessageClass:"m-directories-error-message",errorMessageTag:"<p>",errorMessageDataAttr:"error-message",errorDefaultMessage:"Something went wrong. We have been notified and are working to fix the issue."},itemConfig:{selector:".aws-directories-item",endpoint:"/api/dirs/{{directoryId}}/items/{{itemId}}"},APIs:{getItems:{endpoint:"/api/dirs/{{directoryId}}/items",defaultParams:{order_by:"dateCreated",sort_ascending:false,limit:25,locale:PathUtils.getLocale()}},search:{endpoint:"/api/dirs/items/search?item.directoryId={{directoryId}}",defaultParams:{sort_by:"item.dateCreated",sort_order:"desc",size:25,"item.locale":PathUtils.getLocale()}}},metricsConfig:{prefix:"awsm_v2_:comp_",metric:{LoadError:"TemplateLoadError",AjaxError:"AjaxFailure",MissingDataError:"MissingDataError",MismatchedDataCountError:"MismatchedDataCountError",AjaxSuccess:"AjaxSuccess",AjaxRequestToPromiseTime:"AjaxRequestToPromiseTime"}}}});define("directories/directories-utils/tag-utils",[],function(){var TagUtils={getFullTagId:function(isGlobal,excludeTaggedItems,tagNamespace,tagId,directoryId){if(!isGlobal&&!directoryId){throw new Error("Directory ID arg must be passed in when scope is local.")}var fullTagId="";if(isGlobal){fullTagId="GLOBAL#"+tagNamespace+"#"+tagId}else{fullTagId=directoryId+"#"+tagNamespace+"#"+tagId}return excludeTaggedItems?"!"+fullTagId:fullTagId}};return TagUtils});define("librastandardlib/test-helpers/browser-globals/window",[],function(){return window});define("librastandardlib/obj-utils/assign",[],function(){return function assign(target,args){"use strict";if(target===null){throw new TypeError("Cannot convert undefined or null to object")}var to=Object(target);for(var i=1;i<arguments.length;i++){var source=arguments[i];if(source!==null){for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){to[key]=source[key]}}}}return to}});define("librastandardlib/id-utils/generateUUID",[],function(){"use strict";return function generateUUID(){var d=(new Date).getTime();var id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c==="x"?r:r&3|8).toString(16)});return id}});define("librastandardlib/url-utils/buildQueryString",[],function(){"use strict";return function buildQueryString(params){var parts=[];for(var key in params){if(params.hasOwnProperty(key)){parts[parts.length]=encodeURIComponent(key)+"="+encodeURIComponent(params[key])}}return parts.join("&")}});define("librastandardlib/url-utils/getQueryStringParam",[],function(){"use strict";return function getQueryStringParam(name,querySrting){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var re=new RegExp("[\\?&]"+name+"=([^&#]*)");var res=re.exec(querySrting);if(res===null){return""}return decodeURIComponent(res[1].replace(/\+/g," "))}});define("librastandardlib/detection-utils/isUserAgentRobot",["librastandardlib/test-helpers/browser-globals/window"],function(window){"use strict";var ROBOTS_USER_AGENTS=["AdsBot","AmazonAutoTester","Baiduspider","BingBot","BingPreview","bitdiscovery","CloudWatchSynthetics","Googlebot","GoogleImageProxy","HeadlessChrome","Mediapartners-Google","msnbot","Cypress","PTST"];var re=new RegExp(ROBOTS_USER_AGENTS.join("|"),"i");return function isUserAgentRobot(){return re.test(window.navigator.userAgent)}});define("librastandardlib/aws/page-settings",["librastandardlib/obj-utils/assign"],function(_assign){"use strict";var defaults={staticAssetPath:"https://a0.awsstatic.com",jsAssetPath:"https://a0.awsstatic.com/libra/1",isLoggingEnabled:true};var PageSettings={};if(typeof AWS==="object"&&typeof AWS.PageSettings==="object"){_assign(PageSettings,AWS.PageSettings)}var tagSettings=document.getElementsByTagName("html")[0].dataset;if(tagSettings){PageSettings.staticAssetPath=tagSettings.staticAssets;PageSettings.jsAssetPath=PageSettings.staticAssetPath+"/libra/"+tagSettings.jsVersion}PageSettings=_assign({},defaults,PageSettings);if(typeof AWS==="object"&&typeof AWS.PageSettings==="object"){AWS.PageSettings=PageSettings}return PageSettings});define("librastandardlib/logger/logger",["librastandardlib/test-helpers/browser-globals/window","librastandardlib/obj-utils/assign","librastandardlib/id-utils/generateUUID","librastandardlib/url-utils/buildQueryString","librastandardlib/url-utils/getQueryStringParam","librastandardlib/detection-utils/isUserAgentRobot","librastandardlib/aws/page-settings"],function(window,_assign,generateUUID,buildQueryString,getQueryStringParam,isUserAgentRobot,PageSettings){"use strict";var Logger=function(){var LOG_LEVELS={info:{warn:true,error:true},warn:{error:true},error:{},debug:{info:true,warn:true,error:true}};var RAW_ENDPOINT="https://fls-na.amazon.com/1/aws-mktg/1/OE/";var AI_ENDPOINT="https://fls-na.amazon.com/1/action-impressions/1/OE/aws-mktg/action/";var COMMON_AI_PARAMS={marketplaceId:"A12QK8IU0H0XW5",requestId:"ABCDEFGHIJKLMNOPQRST",session:"123-1234567-1234567"};var DEFAULT_AI_UNITS="ms";var DEFAULT_AI_VALUE_SET="count";var AI_VALUE_SETS={count:{value:"1",units:"c"},timeSinceResponseEnd:{valueFunction:"getElapsedTimeSincePageLoad",units:"ms"}};var HOSTNAMES_TO_SERVICES=[{hostname:"console.aws.amazon.com",service:"console"},{hostname:"aws.amazon.com",service:"awsm"},{hostname:"amazonaws-china.com",service:"awsm"},{hostname:"www.amazonaws.cn",service:"cn"}];var LogType={RAW:"RAW",AI:"AI",LOCAL:"LOCAL"};var PlatformType={CMS:"CMS",DEFAULT:"DEFAULT"};var SERVICES_TO_PLATFORM_TYPES={awsm:PlatformType.CMS,cn:PlatformType.CMS,console:PlatformType.DEFAULT,marketplace:PlatformType.CMS};var MARKETPLACE_SERVICE="marketplace";var CONSOLE_SERVICE_NAME_PREFIX="console-";var SERVICE_NAME_REGEX=/console\.(aws\.amazon\.com|amazonaws\.cn)\/([a-z0-9]+)\//;var ALLOWED_HOSTNAME_SUFFIXES=["console.aws.amazon.com","console.amazonaws.cn"];var ALLOWED_EXACT_MATCH_HOSTNAMES={"aws.amazon.com":1,"amazonaws-china.com":1,"www.amazonaws.cn":1};var pageRequestId=null;var instances={};var customMarketplace={CookieConsent:"NA"};function Logger(namespace,logLevel){if(instances.hasOwnProperty(namespace)){instances[namespace].logLevel=logLevel||instances[namespace].logLevel;return instances[namespace]}this.namespace=namespace;this.logLevel=logLevel||this.getLogLevelByQueryString();this.pageRequestId=this.getPageRequestId();this.dataSet=this.getDataSet();this.service=this.getService();this.instance=this.getInstance(this.service);this.client=this.getClient();this.host=this.getHost();this.methodName=this.getMethodName();this.marketplace=customMarketplace[this.namespace]||this.getLongLanguage();instances[namespace]=this}Logger.prototype={getService:function(){if(typeof window.location.hostname!=="undefined"&&typeof window.location.pathname!=="undefined"){if(PageSettings.isMarketplace){return MARKETPLACE_SERVICE}var consoleServiceNameMatch=(window.location.hostname+window.location.pathname).match(SERVICE_NAME_REGEX);if(consoleServiceNameMatch&&consoleServiceNameMatch.length===3){return CONSOLE_SERVICE_NAME_PREFIX+consoleServiceNameMatch[2]}}for(var i=0,len=HOSTNAMES_TO_SERVICES.length;i<len;i++){var hostname=HOSTNAMES_TO_SERVICES[i].hostname;var re=new RegExp(hostname+"\\/");if(re.test(window.location.hostname+"/")||re.test(window.location.pathname)||re.test(window.location.hash)){return HOSTNAMES_TO_SERVICES[i].service}}return"NA"},getHost:function(){if(typeof window.location.hostname!=="undefined"){var hostname=window.location.hostname;if(ALLOWED_EXACT_MATCH_HOSTNAMES.hasOwnProperty(hostname)){return hostname}for(var i=0;i<ALLOWED_HOSTNAME_SUFFIXES.length;i++){var currentHost=ALLOWED_HOSTNAME_SUFFIXES[i];var indexOf=hostname.indexOf(currentHost);var endsWithCurrentHost=indexOf>=0&&indexOf===hostname.length-currentHost.length;if(endsWithCurrentHost){return currentHost}}}return"NA"},getLongLanguage:function(){var langAttr=document.documentElement.getAttribute("lang");if(typeof langAttr==="string"&&langAttr.length){return langAttr.replace("-","_")}return"NA"},getInstance:function(service){var platformType=PlatformType.DEFAULT;if(SERVICES_TO_PLATFORM_TYPES.hasOwnProperty(service)){platformType=SERVICES_TO_PLATFORM_TYPES[service]}if(platformType===PlatformType.CMS){if(window.location.pathname.indexOf(".html")===window.location.pathname.length-5){if("logInstance"in PageSettings){return PageSettings.logInstance}return"NA"}return"LIVE"}return"LIVE"},getDataSet:function(){if("logDataSet"in PageSettings){return PageSettings.logDataSet}return"NA"},getClient:function(){var re=new RegExp(/iPhone|iPod|iPad|Android|(?=.*\bAndroid\b)(?=.*\bMobile\b)|IEMobile|(?=.*\bWindows\b)(?=.*\bTouch\b)|Windows Phone|Opera Mini|(?=.*\bFirefox\b)(?=.*\bMobile\b)|BlackBerry|Nexus 7|BNTV250|Kindle Fire|Silk|webOS|GT-P1000/i);if(re.test(window.navigator.userAgent)){return"mobile"}return"dsk"},getMethodName:function(){if(isUserAgentRobot()){return"bot"}return"NA"},logAI:function(metric,params){params=params||{};var valueSet;if(params.hasOwnProperty("valueSet")){if(AI_VALUE_SETS.hasOwnProperty(params.valueSet)){valueSet=AI_VALUE_SETS[params.valueSet];params.units=valueSet.units;if(valueSet.hasOwnProperty("valueFunction")){params.value=this[valueSet.valueFunction]()}else{params.value=valueSet.value}}else{valueSet=AI_VALUE_SETS[DEFAULT_AI_VALUE_SET];params.value=valueSet.value;params.units=valueSet.units}}else if(!params.hasOwnProperty("value")){valueSet=AI_VALUE_SETS[DEFAULT_AI_VALUE_SET];params.value=valueSet.value;params.units=valueSet.units}if(!params.hasOwnProperty("units")){params.units=DEFAULT_AI_UNITS}var url=AI_ENDPOINT+metric+"@v="+encodeURIComponent(params.value)+":u="+encodeURIComponent(params.units);var standardParams={dataset:this.dataSet,instance:this.instance,service:this.service,marketplace:this.marketplace,client:this.client,host:this.host,method:this.methodName};var queryStringParams=_assign(standardParams,COMMON_AI_PARAMS);url+="?"+buildQueryString(queryStringParams);this.logUrl(url)},logRaw:function(logLevel,msg,currentTime,pageTime,customParams){var standardParams={cat:this.namespace,level:logLevel,msg:msg,currentTime:currentTime,method:this.methodName,pageTime:pageTime,pageRequestId:pageRequestId,page:window.location.toString()};var params=_assign({},customParams,standardParams);var url=RAW_ENDPOINT+"?"+buildQueryString(params);this.logUrl(url)},logUrl:function(url){if(PageSettings.isLoggingEnabled){setTimeout(function(){(new Image).src=url},0);this._lastImageUrl=url}},getLogLevelByQueryString:function(){var level=getQueryStringParam("debug"+this.namespace,window.location.search);if(level===""){return null}return level},getElapsedTimeSincePageLoad:function(){if("performance"in window&&"timing"in window.performance){return(new Date).getTime()-window.performance.timing.responseEnd}return-1},getPageRequestId:function(){pageRequestId=pageRequestId||generateUUID();return pageRequestId},_rawEndpoint:RAW_ENDPOINT,_aiEndpoint:AI_ENDPOINT};for(var level in LOG_LEVELS){if(LOG_LEVELS.hasOwnProperty(level)){(function(level){Logger.prototype[level]=function(msg,logType,params){logType=logType||"LOCAL";var currentTime=(new Date).getTime();var pageTime=this.getElapsedTimeSincePageLoad();var logLevelStr=level.toUpperCase();if(logType===LogType.AI){this.logAI(msg,params)}else if(logType===LogType.RAW){this.logRaw(logLevelStr,msg,currentTime,pageTime,params)}if(this.logLevel!==null){if(level===this.logLevel||LOG_LEVELS[this.logLevel].hasOwnProperty(level)){if(LogType.hasOwnProperty(logType)){var out="["+logLevelStr+"]["+LogType[logType]+"] "+this.namespace+": "+msg+"; @"+pageTime+"ms";if(typeof params!=="undefined"){out+="; "+JSON.stringify(params)}console.log(out);this._lastConsoleLog=out}else{var args=Array.prototype.slice.call(arguments);var logObjPrefix="["+logLevelStr+"]["+LogType.LOCAL+"] "+this.namespace+": "+args[0];console.log(logObjPrefix,[].concat(args.slice(1)))}}}}})(level)}}return Logger}();return Logger});define("librastandardlib/vendor/lodash-amd/modern/internal/baseToString",[],function(){function baseToString(value){return value==null?"":value+""}return baseToString});define("librastandardlib/vendor/lodash-amd/modern/string/startsWith",["../internal/baseToString"],function(baseToString){var nativeMin=Math.min;function startsWith(string,target,position){string=baseToString(string);position=position==null?0:nativeMin(position<0?0:+position||0,string.length);return string.lastIndexOf(target,position)==position}return startsWith});define("libra/components/global-map-pin",["directories/configurations/default-config","directories/directories-bundle","libra/templates/global-map","directories/directories-utils/tag-utils","librastandardlib/obj-utils/mixin","librastandardlib/logger/logger","librastandardlib/vendor/lodash-amd/modern/string/startsWith","libra/event-utils/event-keys"],function(defaultConfig,DirectoriesBundle,HandlebarsTemplates,TagUtils,mixin,Logger,_startsWith,eventKeys){var logger=new Logger("MapPin");var Metric=defaultConfig.metricsConfig.metric;var options={componentName:"GlobalMapPins",itemsConfig:{selector:".m-gi-map-pin",containerClass:".m-gi-map-pin-details-container"},APIs:{search:{defaultParams:{size:250,sort_by:"item.additionalFields.y",sort_order:"desc"}}},templates:HandlebarsTemplates};var defaults={newContentEvent:"custom_libra_require_new-content",pinWrapperSelector:".m-gi-pin-wrapper",pinClassPrefix:"m-gi-pin-",pinPopoverClassPrefix:"m-gi-pin-popover-",mapIdAttribute:"data-map-id",filterOperator:"awsm:pinFilterOperator",color:"awsm:pinColor",label:"awsm:pinLabel",customTags:"awsm:pinFilterTags",tagId:"awsm:tagId",tagNamespaceId:"awsm:tagNamespaceId",isGlobalTag:"awsm:isGlobalTag",excludeTaggedItems:"awsm:excludeTaggedItems"};function GlobalMapPins(elem){this.$elem=$(elem);this.$pinWrapper=this.$elem.parent().find(".m-gi-pin-wrapper");this.$mapKey=this.$elem.parent().find(".m-gi-map-key");this.directoryId=this.$elem.data().directoryId;this.init(options);this.template=this.getTemplate();if(this.template){this.loadData({},true)}}GlobalMapPins.prototype={processData:function(data,replaceContent){this.displayItems(data,replaceContent);var $pinDetailBox=this.$elem.find(".m-gi-pin-detail-box");if($pinDetailBox.length>0&&this.$elem.hasClass("dark")){$pinDetailBox.addClass("m-dark-mode")}this.pinsData=data.items;this.pinsContext=this.$elem.data().hbsContext;if(this.pinsData.length!==data.metadata.totalHits){var metricName=this.getMetricName(Metric.MismatchedDataCountError);logger.error(metricName,"AI");logger.error(metricName+"; DirectoryId="+this.directoryId+"; "+JSON.stringify(this.updatedParams),"RAW")}this.plotPins();this.plotLabels();$(document).trigger(defaults.newContentEvent)},plotPins:function(){if(!this.pinsContext.customPins.length){for(var legacyPinIndex=0;legacyPinIndex<this.pinsData.length;legacyPinIndex++){this.plotPin(legacyPinIndex)}}else{var plottedPins=this.getFilteredPins().sort(function(a,b){return a.index-b.index});for(var plottedPinIndex=0;plottedPinIndex<plottedPins.length;plottedPinIndex++){var plottedPin=plottedPins[plottedPinIndex];this.plotPin(plottedPin.index,plottedPin.color)}}},plotPin:function(pinIndex,color){var pinData=this.pinsData[pinIndex];var leftCord=pinData.item.additionalFields.x+"%";var bottomCord=pinData.item.additionalFields.y+"%";var css={left:leftCord,bottom:bottomCord};var attr={"data-lb-popover-trigger":defaults.pinPopoverClassPrefix+this.$pinWrapper.attr(defaults.mapIdAttribute)+"-"+pinIndex,tabindex:0,id:this.pinsContext.mapId+"-pin-"+pinIndex+"-trigger"};if(color){css["--pin-color"]=color}else{attr["data-is-soon"]=pinData.item.additionalFields.isSoon}$("<div/>").appendTo(this.$pinWrapper).addClass(defaults.pinClassPrefix+pinIndex).attr(attr).css(css).focus(function(){$(this).addClass("lb-active")}).focusout(function(){$(this).removeClass("lb-active")}).on("keyup",function(event){if(event.key===eventKeys.ENTER||event.key===eventKeys.SPACE){$(this).trigger("click");$(this).addClass("lb-active")}}).show()},plotLabels:function(){if(this.pinsContext.customPins.length){this.$mapKey.empty();this.pinsContext.customPins.forEach(function(customPinData){$("<div>"+customPinData[defaults.label]+"</div>").appendTo(this.$mapKey).css({"--pin-color":customPinData[defaults.color]}).show()},this)}},getFilteredPins:function(){var customPinsContext=this.pinsContext.customPins;var plottedPins=[];customPinsContext.forEach(function(pinContext,pinContextIndex){if(pinContext["item"+pinContextIndex]){var filterTagArr=pinContext["item"+pinContextIndex][0][defaults.customTags];var filterTagIds=this.buildFilterTagIds(filterTagArr);var includeTagsCount=Object.keys(filterTagIds).filter(function(tagId){return!_startsWith(tagId,"!")}).length;var filterTagsRequired=pinContext[defaults.filterOperator]==="and"?includeTagsCount:1;this.pinsData.forEach(function(pinData,pinIndex){var pinTags=pinData.tags;var filterTagsCount=0;var hasExcludeTag=false;if(pinTags){filterTagsCount=pinTags.filter(function(pinTag){return pinTag.id in filterTagIds}).length;hasExcludeTag=pinTags.some(function(pinTag){return"!"+pinTag.id in filterTagIds})}if(filterTagsCount>=filterTagsRequired&&!hasExcludeTag){plottedPins.push({index:pinIndex,color:pinContext[defaults.color]})}},this)}},this);return plottedPins},buildFilterTagIds:function(filterTagArr){var filterTagIds={};filterTagArr.forEach(function(filterTagObj){var filterTagId=TagUtils.getFullTagId(filterTagObj[defaults.isGlobalTag]==="yes",filterTagObj[defaults.excludeTaggedItems]==="yes",filterTagObj[defaults.tagNamespaceId],filterTagObj[defaults.tagId],this.directoryId);filterTagIds[filterTagId]=true},this);return filterTagIds}};mixin(GlobalMapPins.prototype,DirectoriesBundle.DirectoriesMixin);return GlobalMapPins});define("libra/components/global-map-modal",["directories/directories-bundle","libra/templates/global-map","librastandardlib/obj-utils/mixin"],function(DirectoriesBundle,HandlebarsTemplates,mixin){var options={componentName:"GIMapModal",itemsConfig:{selector:".m-gi-map-modal",containerClass:".m-gi-map-modal-container"},templates:HandlebarsTemplates};function MapModal(elem){this.$elem=$(elem);this.$modalContent=this.$elem.find(".m-gi-map-modal-content");this.init(options);this.template=this.getTemplate();if(this.template){this.loadData({},true)}}MapModal.prototype={processData:function(data,replaceContent){this.displayItems(data,replaceContent)}};mixin(MapModal.prototype,DirectoriesBundle.DirectoriesMixin);return MapModal});define("libra/components/gi-map",["libra/components/global-map-area","libra/components/global-map-pin","libra/components/global-map-modal","libra/event-utils/event-keys"],function(MapArea,MapPin,MapModal,eventKeys){function GIMap(elem){this.$elem=$(elem);new MapArea(this.$elem.find(".m-gi-map-area-details").first());new MapPin(this.$elem.find(".m-gi-map-pin").first());var $mapModalElem=this.$elem.next(".m-gi-map-modal");if($mapModalElem.length){new MapModal($mapModalElem)}this.registerAccessibilityHandlers()}GIMap.prototype={registerAccessibilityHandlers:function(){var $modalBtn=this.$elem.find(".m-gi-map-modal-btn");if($modalBtn.length){$modalBtn.on("keyup",function(event){if(event.key===eventKeys.ENTER||event.key===eventKeys.SPACE){this.click()}})}var $skipElement=this.$elem.find(".m-gi-map-skip");var $linkElement=this.$elem.find(".m-gi-map-cta-link").length?this.$elem.find(".m-gi-map-cta-link"):this.$elem.next();function handleSkipMap(event){event.preventDefault();$linkElement.focus();$skipElement.blur()}if($skipElement.length&&$linkElement.length){$skipElement.on("click",handleSkipMap);$skipElement.on("keyup",function(event){if(event.key===eventKeys.ENTER||event.key===eventKeys.SPACE){handleSkipMap(event)}})}}};Libra.Comp.register({name:"gi-map",initFct:function(elem){new GIMap(elem)},initTime:"immediate"});return GIMap})})();